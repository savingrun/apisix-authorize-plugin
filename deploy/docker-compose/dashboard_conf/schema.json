{"stream_plugins":{"limit-conn":{"schema":{"required":["conn","burst","default_conn_delay","key"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"key_type":{"default":"var","enum":["var","var_combination"],"type":"string"},"key":{"type":"string"},"default_conn_delay":{"type":"number","exclusiveMinimum":0},"only_use_default_delay":{"type":"boolean","default":false},"disable":{"type":"boolean"},"burst":{"type":"integer","minimum":0},"conn":{"type":"integer","exclusiveMinimum":0}}},"priority":1003,"version":0.1},"ip-restriction":{"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"message":{"default":"Your IP address is not allowed","minLength":1,"type":"string","maxLength":1024},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"whitelist":{"minItems":1,"type":"array","items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}},"blacklist":{"minItems":1,"type":"array","items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}}}},"priority":3000,"version":0.1},"syslog":{"version":0.1,"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}}},"priority":401,"schema":{"required":["host","port"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"port":{"type":"integer"},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"max_retry_count":{"default":0,"type":"integer","minimum":0},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"pool_size":{"default":5,"type":"integer","minimum":5},"flush_limit":{"default":4096,"type":"integer","minimum":1},"drop_limit":{"type":"integer","default":1048576},"tls":{"type":"boolean","default":false},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"timeout":{"default":3000,"type":"integer","minimum":1},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"name":{"type":"string","default":"stream sys logger"},"host":{"type":"string"},"sock_type":{"default":"tcp","enum":["tcp","udp"],"type":"string"}}}},"mqtt-proxy":{"schema":{"required":["protocol_name","protocol_level"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"protocol_name":{"type":"string"},"disable":{"type":"boolean"},"upstream":{"oneOf":[{"required":["host","port"]},{"required":["ip","port"]}],"properties":{"port":{"type":"number"},"ip":{"type":"string"},"host":{"type":"string"}},"description":"Deprecated. We should configure upstream outside of the plugin","type":"object"},"protocol_level":{"type":"integer"}}},"priority":1000,"version":0.1}},"main":{"service":{"type":"object","properties":{"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"update_time":{"type":"integer"},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"type":"object","properties":{"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"update_time":{"type":"integer"},"discovery_args":{"type":"object","properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"required":["client_key"],"not":{"required":["client_cert_id"]}},"client_key":{"required":["client_cert"],"not":{"required":["client_cert_id"]}}},"type":"object","properties":{"verify":{"default":false,"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_key":{"minLength":128,"type":"string","maxLength":65536}}},"keepalive_pool":{"type":"object","properties":{"requests":{"default":1000,"type":"integer","minimum":1},"size":{"default":320,"type":"integer","minimum":1},"idle_timeout":{"default":60,"type":"number","minimum":0}}},"type":{"description":"algorithms of load balancing","type":"string"},"timeout":{"required":["connect","send","read"],"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0}}},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"passive":{"default":{"unhealthy":{"http_failures":0,"tcp_failures":0,"http_statuses":[429,500,503],"timeouts":0},"type":"http","healthy":{"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"successes":0}},"type":"object","properties":{"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,500,503],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0}}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"healthy":{"type":"object","properties":{"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"type":"array"},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}}}}},"active":{"type":"object","properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"healthy":{"type":"object","properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,302],"minItems":1,"type":"array"},"interval":{"default":1,"type":"integer","minimum":1}}},"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"interval":{"default":1,"type":"integer","minimum":1}}},"req_headers":{"minItems":1,"type":"array","items":{"type":"string","uniqueItems":true}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"timeout":{"type":"number","default":1},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"https_verify_certificate":{"type":"boolean","default":true}}}}},"name":{"minLength":1,"type":"string","maxLength":100},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"retry_timeout":{"type":"number","minimum":0},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"required":["host","port","weight"],"type":"object","properties":{"port":{"type":"integer","description":"port of node","minimum":1},"weight":{"type":"integer","description":"weight of node","minimum":0},"metadata":{"description":"metadata of node","type":"object"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"priority":{"default":0,"description":"priority of node","type":"integer"}}}}]},"scheme":{"default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"service_name":{"minLength":1,"type":"string","maxLength":256},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"desc":{"type":"string","maxLength":256},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"hash_on":{"default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string"}}},"plugins":{"type":"object"},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"hosts":{"uniqueItems":true,"minItems":1,"type":"array","items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"}},"desc":{"type":"string","maxLength":256},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"name":{"minLength":1,"type":"string","maxLength":100},"script":{"minLength":10,"type":"string","maxLength":102400},"create_time":{"type":"integer"}}},"stream_route":{"type":"object","properties":{"sni":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","description":"server name indication","type":"string"},"server_addr":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}],"description":"server IP","type":"string"},"update_time":{"type":"integer"},"server_port":{"description":"server port","type":"integer"},"protocol":{"required":["name"],"type":"object","properties":{"superior_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"name":{"type":"string"},"logger":{"type":"array","items":{"properties":{"name":{"type":"string"},"conf":{"description":"logger plugin configuration","type":"object"},"filter":{"description":"logger filter rules","type":"array"}},"dependencies":{"name":["conf"]}}},"conf":{"description":"protocol-specific configuration","type":"object"}}},"remote_addr":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}],"description":"client IP","type":"string"},"plugins":{"type":"object"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"type":"object","properties":{"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"update_time":{"type":"integer"},"discovery_args":{"type":"object","properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"required":["client_key"],"not":{"required":["client_cert_id"]}},"client_key":{"required":["client_cert"],"not":{"required":["client_cert_id"]}}},"type":"object","properties":{"verify":{"default":false,"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_key":{"minLength":128,"type":"string","maxLength":65536}}},"keepalive_pool":{"type":"object","properties":{"requests":{"default":1000,"type":"integer","minimum":1},"size":{"default":320,"type":"integer","minimum":1},"idle_timeout":{"default":60,"type":"number","minimum":0}}},"type":{"description":"algorithms of load balancing","type":"string"},"timeout":{"required":["connect","send","read"],"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0}}},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"passive":{"default":{"unhealthy":{"http_failures":0,"tcp_failures":0,"http_statuses":[429,500,503],"timeouts":0},"type":"http","healthy":{"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"successes":0}},"type":"object","properties":{"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,500,503],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0}}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"healthy":{"type":"object","properties":{"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"type":"array"},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}}}}},"active":{"type":"object","properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"healthy":{"type":"object","properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,302],"minItems":1,"type":"array"},"interval":{"default":1,"type":"integer","minimum":1}}},"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"interval":{"default":1,"type":"integer","minimum":1}}},"req_headers":{"minItems":1,"type":"array","items":{"type":"string","uniqueItems":true}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"timeout":{"type":"number","default":1},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"https_verify_certificate":{"type":"boolean","default":true}}}}},"name":{"minLength":1,"type":"string","maxLength":100},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"retry_timeout":{"type":"number","minimum":0},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"required":["host","port","weight"],"type":"object","properties":{"port":{"type":"integer","description":"port of node","minimum":1},"weight":{"type":"integer","description":"weight of node","minimum":0},"metadata":{"description":"metadata of node","type":"object"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"priority":{"default":0,"description":"priority of node","type":"integer"}}}}]},"scheme":{"default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"service_name":{"minLength":1,"type":"string","maxLength":256},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"desc":{"type":"string","maxLength":256},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"hash_on":{"default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string"}}},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"}}},"plugins":{"type":"array","items":{"required":["name"],"type":"object","properties":{"stream":{"type":"boolean"},"name":{"type":"string","minLength":1}}}},"ssl":{"if":{"properties":{"type":{"enum":["server"]}}},"else":{"required":["key","cert"]},"type":"object","properties":{"sni":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"validity_start":{"type":"integer"},"key":{"minLength":128,"type":"string","maxLength":65536},"create_time":{"type":"integer"},"update_time":{"type":"integer"},"snis":{"minItems":1,"type":"array","items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"}},"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"status":{"default":1,"enum":[1,0],"description":"ssl status, 1 to enable, 0 to disable","type":"integer"},"validity_end":{"type":"integer"},"exptime":{"type":"integer","minimum":1588262400},"certs":{"type":"array","items":{"minLength":128,"type":"string","maxLength":65536}},"cert":{"minLength":128,"type":"string","maxLength":65536},"keys":{"type":"array","items":{"minLength":128,"type":"string","maxLength":65536}},"type":{"default":"server","enum":["server","client"],"description":"ssl certificate type, server to server certificate, client to client certificate for upstream","type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"client":{"required":["ca"],"type":"object","properties":{"ca":{"minLength":128,"type":"string","maxLength":65536},"depth":{"default":1,"type":"integer","minimum":0}}}},"then":{"oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}]}},"proto":{"required":["content"],"type":"object","properties":{"content":{"minLength":1,"type":"string","maxLength":1048576},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"}}},"plugin_config":{"required":["id","plugins"],"properties":{"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"update_time":{"type":"integer"},"plugins":{"type":"object"},"desc":{"type":"string","maxLength":256},"create_time":{"type":"integer"}},"type":"object"},"global_rule":{"required":["plugins"],"properties":{"update_time":{"type":"integer"},"create_time":{"type":"integer"},"plugins":{"type":"object"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]}},"type":"object"},"upstream_hash_header_schema":{"type":"string","pattern":"^[a-zA-Z0-9-_]+$"},"upstream_hash_vars_schema":{"type":"string","pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname)|arg_[0-9a-zA-z_-]+)$"},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"type":"object","properties":{"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"update_time":{"type":"integer"},"discovery_args":{"type":"object","properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"required":["client_key"],"not":{"required":["client_cert_id"]}},"client_key":{"required":["client_cert"],"not":{"required":["client_cert_id"]}}},"type":"object","properties":{"verify":{"default":false,"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_key":{"minLength":128,"type":"string","maxLength":65536}}},"keepalive_pool":{"type":"object","properties":{"requests":{"default":1000,"type":"integer","minimum":1},"size":{"default":320,"type":"integer","minimum":1},"idle_timeout":{"default":60,"type":"number","minimum":0}}},"type":{"description":"algorithms of load balancing","type":"string"},"timeout":{"required":["connect","send","read"],"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0}}},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"passive":{"default":{"unhealthy":{"http_failures":0,"tcp_failures":0,"http_statuses":[429,500,503],"timeouts":0},"type":"http","healthy":{"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"successes":0}},"type":"object","properties":{"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,500,503],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0}}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"healthy":{"type":"object","properties":{"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"type":"array"},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}}}}},"active":{"type":"object","properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"healthy":{"type":"object","properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,302],"minItems":1,"type":"array"},"interval":{"default":1,"type":"integer","minimum":1}}},"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"interval":{"default":1,"type":"integer","minimum":1}}},"req_headers":{"minItems":1,"type":"array","items":{"type":"string","uniqueItems":true}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"timeout":{"type":"number","default":1},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"https_verify_certificate":{"type":"boolean","default":true}}}}},"name":{"minLength":1,"type":"string","maxLength":100},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"retry_timeout":{"type":"number","minimum":0},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"required":["host","port","weight"],"type":"object","properties":{"port":{"type":"integer","description":"port of node","minimum":1},"weight":{"type":"integer","description":"weight of node","minimum":0},"metadata":{"description":"metadata of node","type":"object"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"priority":{"default":0,"description":"priority of node","type":"integer"}}}}]},"scheme":{"default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"service_name":{"minLength":1,"type":"string","maxLength":256},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"desc":{"type":"string","maxLength":256},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"hash_on":{"default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string"}}},"consumer":{"required":["username"],"type":"object","properties":{"username":{"pattern":"^[a-zA-Z0-9_]+$","minLength":1,"type":"string","maxLength":100},"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"desc":{"type":"string","maxLength":256},"update_time":{"type":"integer"},"plugins":{"type":"object"},"create_time":{"type":"integer"}}},"route":{"allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}],"not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]},"properties":{"plugin_config_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"update_time":{"type":"integer"},"service_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"status":{"default":1,"enum":[1,0],"description":"route status, 1 to enable, 0 to disable","type":"integer"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"timeout":{"required":["connect","send","read"],"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0}}},"priority":{"type":"integer","default":0},"name":{"minLength":1,"type":"string","maxLength":100},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"create_time":{"type":"integer"},"service_protocol":{"enum":["grpc","http"]},"remote_addrs":{"uniqueItems":true,"minItems":1,"type":"array","items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}],"description":"client IP","type":"string"}},"plugins":{"type":"object"},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"type":"object","properties":{"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"update_time":{"type":"integer"},"discovery_args":{"type":"object","properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"required":["client_key"],"not":{"required":["client_cert_id"]}},"client_key":{"required":["client_cert"],"not":{"required":["client_cert_id"]}}},"type":"object","properties":{"verify":{"default":false,"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_key":{"minLength":128,"type":"string","maxLength":65536}}},"keepalive_pool":{"type":"object","properties":{"requests":{"default":1000,"type":"integer","minimum":1},"size":{"default":320,"type":"integer","minimum":1},"idle_timeout":{"default":60,"type":"number","minimum":0}}},"type":{"description":"algorithms of load balancing","type":"string"},"timeout":{"required":["connect","send","read"],"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0}}},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"passive":{"default":{"unhealthy":{"http_failures":0,"tcp_failures":0,"http_statuses":[429,500,503],"timeouts":0},"type":"http","healthy":{"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"successes":0}},"type":"object","properties":{"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,500,503],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0}}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"healthy":{"type":"object","properties":{"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"type":"array"},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}}}}},"active":{"type":"object","properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"healthy":{"type":"object","properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,302],"minItems":1,"type":"array"},"interval":{"default":1,"type":"integer","minimum":1}}},"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"interval":{"default":1,"type":"integer","minimum":1}}},"req_headers":{"minItems":1,"type":"array","items":{"type":"string","uniqueItems":true}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"timeout":{"type":"number","default":1},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"https_verify_certificate":{"type":"boolean","default":true}}}}},"name":{"minLength":1,"type":"string","maxLength":100},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"retry_timeout":{"type":"number","minimum":0},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"required":["host","port","weight"],"type":"object","properties":{"port":{"type":"integer","description":"port of node","minimum":1},"weight":{"type":"integer","description":"weight of node","minimum":0},"metadata":{"description":"metadata of node","type":"object"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"priority":{"default":0,"description":"priority of node","type":"integer"}}}}]},"scheme":{"default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"service_name":{"minLength":1,"type":"string","maxLength":256},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"desc":{"type":"string","maxLength":256},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"hash_on":{"default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string"}}},"hosts":{"uniqueItems":true,"minItems":1,"type":"array","items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"}},"methods":{"uniqueItems":true,"type":"array","items":{"enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"],"description":"HTTP method","type":"string"}},"uris":{"uniqueItems":true,"minItems":1,"type":"array","items":{"description":"HTTP uri","type":"string"}},"desc":{"type":"string","maxLength":256},"uri":{"minLength":1,"type":"string","maxLength":4096},"remote_addr":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}],"description":"client IP","type":"string"},"vars":{"type":"array"},"filter_func":{"pattern":"^function","type":"string","minLength":10},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"script_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"script":{"minLength":10,"type":"string","maxLength":102400},"enable_websocket":{"description":"enable websocket for request","type":"boolean"}},"anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}],"type":"object"}},"plugins":{"csrf":{"schema":{"required":["key"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"expires":{"default":7200,"description":"expires time(s) for csrf token","type":"integer"},"key":{"description":"use to generate csrf token","type":"string"},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"name":{"default":"apisix-csrf-token","description":"the csrf token name","type":"string"}}},"priority":2980,"version":0.1},"grpc-web":{"version":0.1,"priority":505,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"}}}},"client-control":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"max_body_size":{"type":"integer","minimum":0},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}}}},"priority":22000,"version":0.1},"basic-auth":{"schema":{"$comment":"this is a mark for our injected plugin schema","title":"work with route or service object","type":"object","properties":{"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"hide_credentials":{"type":"boolean","default":false}}},"type":"auth","version":0.1,"priority":2520,"consumer_schema":{"required":["username","password"],"title":"work with consumer object","type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"}}}},"serverless-pre-function":{"version":0.1,"priority":10000,"schema":{"required":["functions"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"functions":{"minItems":1,"type":"array","items":{"type":"string"}},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"phase":{"default":"access","enum":["rewrite","access","header_filter","body_filter","log","before_proxy"],"type":"string"}}}},"udp-logger":{"schema":{"required":["host","port"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"port":{"type":"integer","minimum":0},"include_req_body":{"type":"boolean","default":false},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"timeout":{"default":3,"type":"integer","minimum":1},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"name":{"type":"string","default":"udp logger"},"host":{"type":"string"},"max_retry_count":{"default":0,"type":"integer","minimum":0}}},"priority":400,"version":0.1},"openid-connect":{"schema":{"required":["client_id","client_secret","discovery"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"introspection_endpoint":{"type":"string"},"introspection_endpoint_auth_method":{"type":"string","default":"client_secret_basic"},"redirect_uri":{"type":"string","description":"use ngx.var.request_uri if not configured"},"realm":{"type":"string","default":"apisix"},"logout_path":{"type":"string","default":"\/logout"},"timeout":{"default":3,"description":"timeout in seconds","type":"integer","minimum":1},"ssl_verify":{"type":"boolean","default":false},"post_logout_redirect_uri":{"type":"string","description":"the URI will be redirect when request logout_path"},"token_signing_alg_values_expected":{"type":"string"},"scope":{"type":"string","default":"openid"},"set_access_token_header":{"default":true,"description":"Whether the access token should be added as a header to the request for downstream","type":"boolean"},"public_key":{"type":"string"},"access_token_in_authorization_header":{"default":false,"description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header.","type":"boolean"},"discovery":{"type":"string"},"disable":{"type":"boolean"},"set_id_token_header":{"default":true,"description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream.","type":"boolean"},"bearer_only":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"set_userinfo_header":{"default":true,"description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream.","type":"boolean"},"client_id":{"type":"string"},"client_secret":{"type":"string"},"set_refresh_token_header":{"default":false,"description":"Whether the refresh token should be added in the X-Refresh-Token header to the request for downstream.","type":"boolean"},"use_pkce":{"default":false,"description":"when set to true the PKEC(Proof Key for Code Exchange) will be used.","type":"boolean"}}},"priority":2599,"version":0.1},"proxy-rewrite":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"regex_uri":{"maxItems":2,"type":"array","items":{"description":"regex uri","type":"string"},"minItems":2,"description":"new uri that substitute from client uri for upstream, lower priority than uri property"},"method":{"enum":["TRACE","GET","HEAD","POST","PUT","DELETE","MKCOL","COPY","MOVE","OPTIONS","PROPFIND","LOCK","UNLOCK","PATCH"],"description":"proxy route method","type":"string"},"disable":{"type":"boolean"},"uri":{"type":"string","pattern":"^\\\/.*","description":"new uri for upstream","minLength":1,"maxLength":4096},"scheme":{"enum":["http","https"],"description":"new scheme for upstream","type":"string"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"headers":{"type":"object","description":"new headers for request","minProperties":1},"use_real_request_uri_unsafe":{"default":false,"description":"use real_request_uri instead, THIS IS VERY UNSAFE.","type":"boolean"},"host":{"pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$","description":"new host for upstream","type":"string"}},"type":"object","minProperties":1},"priority":1008,"version":0.1},"wolf-rbac":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"header_prefix":{"type":"string","default":"X-"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"appid":{"type":"string","default":"unset"},"disable":{"type":"boolean"},"server":{"type":"string","default":"http:\/\/127.0.0.1:12180"}}},"version":0.1,"priority":2555,"type":"auth"},"rocketmq-logger":{"version":0.1,"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}}},"priority":402,"schema":{"required":["nameserver_list","topic"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"inactive_timeout":{"default":5,"type":"integer","minimum":1},"access_key":{"type":"string","default":""},"secret_key":{"type":"string","default":""},"meta_format":{"default":"default","enum":["default","origin"],"type":"string"},"nameserver_list":{"minItems":1,"type":"array","items":{"type":"string"}},"tag":{"type":"string"},"use_tls":{"type":"boolean","default":false},"timeout":{"default":3,"type":"integer","minimum":1},"name":{"type":"string","default":"rocketmq logger"},"topic":{"type":"string"},"key":{"type":"string"},"retry_delay":{"default":1,"type":"integer","minimum":0},"include_req_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"disable":{"type":"boolean"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"buffer_duration":{"default":60,"type":"integer","minimum":1},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"max_retry_count":{"default":0,"type":"integer","minimum":0},"include_req_body":{"type":"boolean","default":false},"include_resp_body":{"type":"boolean","default":false}}}},"boom-handle":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"}}},"priority":900000,"version":0.1},"openwhisk":{"schema":{"required":["api_host","service_token","namespace","action"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"namespace":{"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","type":"string","maxLength":256},"package":{"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","type":"string","maxLength":256},"action":{"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","type":"string","maxLength":256},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"result":{"type":"boolean","default":true},"keepalive_pool":{"default":5,"type":"integer","minimum":1},"keepalive":{"type":"boolean","default":true},"timeout":{"maximum":60000,"type":"integer","minimum":1,"default":3000,"description":"timeout in milliseconds"},"ssl_verify":{"type":"boolean","default":true},"keepalive_timeout":{"default":60000,"type":"integer","minimum":1000},"api_host":{"type":"string"},"service_token":{"type":"string"}}},"priority":-1901,"version":0.1},"server-info":{"scope":"global","schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"}}},"priority":990,"version":0.1},"proxy-mirror":{"schema":{"required":["host"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"path":{"type":"string","pattern":"^\/[^?&]+$"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"host":{"type":"string","pattern":"^http(s)?:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?$"},"sample_ratio":{"maximum":1,"default":1,"type":"number","minimum":1e-05}}},"priority":1010,"version":0.1},"ext-plugin-post-resp":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"allow_degradation":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"conf":{"minItems":1,"type":"array","items":{"required":["name","value"],"type":"object","properties":{"value":{"type":"string"},"name":{"minLength":1,"type":"string","maxLength":128}}}}},"type":"object"},"priority":-4000,"version":0.1},"aws-lambda":{"schema":{"required":["function_uri"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"function_uri":{"type":"string"},"disable":{"type":"boolean"},"authorization":{"type":"object","properties":{"iam":{"required":["accesskey","secretkey"],"type":"object","properties":{"service":{"default":"execute-api","type":"string","description":"the service that is receiving the request"},"accesskey":{"type":"string","description":"access key id from from aws iam console"},"aws_region":{"default":"us-east-1","type":"string","description":"the aws region that is receiving the request"},"secretkey":{"type":"string","description":"secret access key from from aws iam console"}}},"apikey":{"type":"string"}}},"keepalive_pool":{"default":5,"type":"integer","minimum":1},"keepalive":{"type":"boolean","default":true},"timeout":{"default":3000,"type":"integer","minimum":100},"ssl_verify":{"type":"boolean","default":true},"keepalive_timeout":{"default":60000,"type":"integer","minimum":1000},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}}}},"priority":-1899,"version":0.1},"opa":{"schema":{"required":["host","policy"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"with_consumer":{"type":"boolean","default":false},"policy":{"type":"string"},"with_route":{"type":"boolean","default":false},"keepalive_pool":{"default":5,"type":"integer","minimum":1},"keepalive":{"type":"boolean","default":true},"timeout":{"maximum":60000,"type":"integer","minimum":1,"default":3000,"description":"timeout in milliseconds"},"ssl_verify":{"type":"boolean","default":true},"keepalive_timeout":{"default":60000,"type":"integer","minimum":1000},"host":{"type":"string"},"with_service":{"type":"boolean","default":false}}},"priority":2001,"version":0.1},"request-id":{"version":0.1,"priority":12015,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"header_name":{"type":"string","default":"X-Request-Id"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"include_in_response":{"type":"boolean","default":true},"disable":{"type":"boolean"},"algorithm":{"default":"uuid","enum":["uuid","snowflake","nanoid"],"type":"string"}}}},"limit-req":{"schema":{"required":["rate","burst","key"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"rejected_code":{"maximum":599,"default":503,"type":"integer","minimum":200},"key":{"type":"string"},"nodelay":{"type":"boolean","default":false},"disable":{"type":"boolean"},"allow_degradation":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"rejected_msg":{"type":"string","minLength":1},"rate":{"type":"number","exclusiveMinimum":0},"burst":{"type":"number","minimum":0},"key_type":{"default":"var","enum":["var","var_combination"],"type":"string"}}},"priority":1001,"version":0.1},"key-auth":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"hide_credentials":{"type":"boolean","default":false},"query":{"type":"string","default":"apikey"},"disable":{"type":"boolean"},"header":{"type":"string","default":"apikey"}}},"type":"auth","version":0.1,"priority":2500,"consumer_schema":{"required":["key"],"type":"object","properties":{"key":{"type":"string"}}}},"ext-plugin-pre-req":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"allow_degradation":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"conf":{"minItems":1,"type":"array","items":{"required":["name","value"],"type":"object","properties":{"value":{"type":"string"},"name":{"minLength":1,"type":"string","maxLength":128}}}}},"type":"object"},"priority":12000,"version":0.1},"boom-log":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"}}},"priority":1,"version":0.1},"file-logger":{"schema":{"required":["path"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"disable":{"type":"boolean"},"path":{"type":"string"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}}}},"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}}},"priority":399,"version":0.1},"example-plugin":{"version":0.1,"metadata_schema":{"required":["ikey","skey"],"type":"object","properties":{"ikey":{"type":"number","minimum":0},"skey":{"type":"string"}}},"priority":0,"schema":{"required":["i"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"port":{"type":"integer"},"s":{"type":"string"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"t":{"type":"array","minItems":1},"ip":{"type":"string"},"disable":{"type":"boolean"},"i":{"type":"number","minimum":0}}}},"tcp-logger":{"schema":{"required":["host","port"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"port":{"type":"integer","minimum":0},"max_retry_count":{"default":0,"type":"integer","minimum":0},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"tls":{"type":"boolean","default":false},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"timeout":{"default":1000,"type":"integer","minimum":1},"tls_options":{"type":"string"},"name":{"type":"string","default":"tcp logger"},"host":{"type":"string"},"include_req_body":{"type":"boolean","default":false}}},"priority":405,"version":0.1},"skywalking-logger":{"schema":{"required":["endpoint_addr"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"include_req_body":{"type":"boolean","default":false},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"service_instance_name":{"type":"string","default":"APISIX Instance Name"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"timeout":{"default":3,"type":"integer","minimum":1},"name":{"type":"string","default":"skywalking logger"},"endpoint_addr":{"type":"string","pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?"},"max_retry_count":{"default":0,"type":"integer","minimum":0},"service_name":{"type":"string","default":"APISIX"}}},"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}}},"priority":408,"version":0.1},"redirect":{"schema":{"oneOf":[{"required":["uri"]},{"required":["regex_uri"]},{"required":["http_to_https"],"not":{"required":["append_query_string"]}}],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"uri":{"pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)","type":"string","minLength":2},"http_to_https":{"type":"boolean"},"encode_uri":{"type":"boolean","default":false},"append_query_string":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"ret_code":{"default":302,"type":"integer","minimum":200},"regex_uri":{"maxItems":2,"type":"array","items":{"description":"regex uri","type":"string"},"minItems":2,"description":"params for generating new uri that substitute from client uri, first param is regular expression, the second one is uri template"}}},"priority":900,"version":0.1},"real-ip":{"schema":{"required":["source"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"recursive":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"trusted_addresses":{"minItems":1,"type":"array","items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}},"disable":{"type":"boolean"},"source":{"type":"string","minLength":1}}},"priority":23000,"version":0.1},"echo":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}],"properties":{"before_body":{"description":"body before the filter phase.","type":"string"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"after_body":{"description":"body after the modification of filter phase.","type":"string"},"headers":{"type":"object","description":"new headers for response","minProperties":1},"disable":{"type":"boolean"},"body":{"description":"body to replace upstream response.","type":"string"}},"minProperties":1},"priority":412,"version":0.1},"proxy-control":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"request_buffering":{"type":"boolean","default":true}}},"priority":21990,"version":0.1},"authz-casbin":{"schema":{"oneOf":[{"required":["model_path","policy_path","username"]},{"required":["model","policy","username"]}],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"policy_path":{"type":"string"},"model":{"type":"string"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"username":{"type":"string"},"disable":{"type":"boolean"},"model_path":{"type":"string"},"policy":{"type":"string"}}},"metadata_schema":{"required":["model","policy"],"type":"object","properties":{"policy":{"type":"string"},"model":{"type":"string"}}},"priority":2560,"version":0.1},"jwt-auth":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"cookie":{"type":"string","default":"jwt"},"query":{"type":"string","default":"jwt"},"disable":{"type":"boolean"},"header":{"type":"string","default":"authorization"}}},"type":"auth","version":0.1,"priority":2510,"consumer_schema":{"dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"default":"HS256","enum":["HS256","HS512"]}}},{"properties":{"private_key":{"type":"string"},"algorithm":{"enum":["RS256"]},"public_key":{"type":"string"}},"required":["public_key","private_key"]},{"properties":{"vault":{"type":"object","properties":{}},"algorithm":{"enum":["RS256"]}},"required":["vault"]}]}},"required":["key"],"type":"object","properties":{"key":{"type":"string"},"base64_secret":{"type":"boolean","default":false},"vault":{"type":"object","properties":{}},"exp":{"default":86400,"type":"integer","minimum":1},"secret":{"type":"string"},"algorithm":{"default":"HS256","enum":["HS256","HS512","RS256"],"type":"string"}}}},"public-api":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"uri":{"type":"string"},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}}}},"priority":501,"version":0.1},"syslog":{"schema":{"required":["host","port"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"inactive_timeout":{"default":5,"type":"integer","minimum":1},"max_retry_times":{"type":"integer","minimum":1},"retry_interval":{"type":"integer","minimum":0},"flush_limit":{"default":4096,"type":"integer","minimum":1},"drop_limit":{"type":"integer","default":1048576},"tls":{"type":"boolean","default":false},"timeout":{"default":3000,"type":"integer","minimum":1},"name":{"type":"string","default":"http sys logger"},"host":{"type":"string"},"port":{"type":"integer"},"include_req_body":{"type":"boolean","default":false},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"pool_size":{"default":5,"type":"integer","minimum":5},"max_retry_count":{"default":0,"type":"integer","minimum":0},"sock_type":{"default":"tcp","enum":["tcp","udp"],"type":"string"}}},"priority":401,"version":0.1},"uri-blocker":{"schema":{"required":["block_rules"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"rejected_code":{"default":403,"type":"integer","minimum":200},"rejected_msg":{"type":"string","minLength":1},"block_rules":{"uniqueItems":true,"type":"array","items":{"minLength":1,"type":"string","maxLength":4096}},"case_insensitive":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"}}},"priority":2900,"version":0.1},"fault-injection":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"delay":{"required":["duration"],"type":"object","properties":{"vars":{"maxItems":20,"type":"array","items":{"type":"array"}},"percentage":{"maximum":100,"type":"integer","minimum":0},"duration":{"type":"number","minimum":0}}},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"abort":{"required":["http_status"],"type":"object","properties":{"vars":{"maxItems":20,"type":"array","items":{"type":"array"}},"percentage":{"maximum":100,"type":"integer","minimum":0},"http_status":{"type":"integer","minimum":200},"body":{"type":"string","minLength":0}}}},"type":"object","minProperties":1},"priority":11000,"version":0.1},"limit-count":{"schema":{"required":["count","time_window"],"else":{"if":{"properties":{"policy":{"enum":["redis-cluster"]}}},"then":{"properties":{"redis_cluster_nodes":{"minItems":2,"type":"array","items":{"minLength":2,"type":"string","maxLength":100}},"redis_cluster_name":{"type":"string"},"redis_timeout":{"default":1000,"type":"integer","minimum":1},"redis_password":{"type":"string","minLength":0}},"required":["redis_cluster_nodes","redis_cluster_name"]}},"type":"object","$comment":"this is a mark for our injected plugin schema","then":{"properties":{"redis_password":{"type":"string","minLength":0},"redis_database":{"default":0,"type":"integer","minimum":0},"redis_timeout":{"default":1000,"type":"integer","minimum":1},"redis_host":{"type":"string","minLength":2},"redis_port":{"default":6379,"type":"integer","minimum":1}},"required":["redis_host"]},"properties":{"rejected_code":{"maximum":599,"default":503,"type":"integer","minimum":200},"key":{"type":"string","default":"remote_addr"},"disable":{"type":"boolean"},"time_window":{"type":"integer","exclusiveMinimum":0},"policy":{"default":"local","enum":["local","redis","redis-cluster"],"type":"string"},"allow_degradation":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"show_limit_quota_header":{"type":"boolean","default":true},"count":{"type":"integer","exclusiveMinimum":0},"group":{"type":"string"},"rejected_msg":{"type":"string","minLength":1},"key_type":{"default":"var","enum":["var","var_combination","constant"],"type":"string"}},"if":{"properties":{"policy":{"enum":["redis"]}}}},"priority":1002,"version":0.4},"prometheus":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"prefer_name":{"type":"boolean","default":false},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}}}},"priority":500,"version":0.2},"forward-auth":{"schema":{"required":["uri"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"request_method":{"default":"GET","enum":["GET","POST"],"type":"string","description":"the method for client to request the authorization service"},"disable":{"type":"boolean"},"upstream_headers":{"default":{},"description":"authorization response header that will be sent to the upstream","type":"array","items":{"type":"string"}},"uri":{"type":"string"},"client_headers":{"default":{},"description":"authorization response header that will be sent tothe client when authorizing failed","type":"array","items":{"type":"string"}},"keepalive":{"type":"boolean","default":true},"timeout":{"maximum":60000,"type":"integer","minimum":1,"default":3000,"description":"timeout in milliseconds"},"ssl_verify":{"type":"boolean","default":true},"keepalive_timeout":{"default":60000,"type":"integer","minimum":1000},"keepalive_pool":{"default":5,"type":"integer","minimum":1},"request_headers":{"default":{},"description":"client request header that will be sent to the authorization service","type":"array","items":{"type":"string"}}}},"priority":2002,"version":0.1},"ldap-auth":{"schema":{"required":["base_dn","ldap_uri"],"type":"object","title":"work with route or service object","properties":{"use_tls":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"base_dn":{"type":"string"},"ldap_uri":{"type":"string"},"uid":{"type":"string"}},"$comment":"this is a mark for our injected plugin schema"},"type":"auth","version":0.1,"priority":2540,"consumer_schema":{"required":["user_dn"],"title":"work with consumer object","type":"object","properties":{"user_dn":{"type":"string"}}}},"gzip":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"http_version":{"default":1.1,"enum":[1.1,1]},"types":{"anyOf":[{"minItems":1,"type":"array","items":{"type":"string","minLength":1}},{"enum":["*"]}],"default":["text\/html"]},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"min_length":{"default":20,"type":"integer","minimum":1},"comp_level":{"maximum":9,"default":1,"type":"integer","minimum":1},"vary":{"type":"boolean"},"disable":{"type":"boolean"},"buffers":{"default":{"size":4096,"number":32},"type":"object","properties":{"size":{"default":4096,"type":"integer","minimum":1},"number":{"default":32,"type":"integer","minimum":1}}}}},"priority":995,"version":0.1},"proxy-cache":{"version":0.2,"priority":1009,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"cache_control":{"type":"boolean","default":false},"cache_bypass":{"minItems":1,"type":"array","items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"}},"no_cache":{"minItems":1,"type":"array","items":{"type":"string","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)"}},"cache_ttl":{"default":300,"type":"integer","minimum":1},"cache_key":{"default":["$host","$request_uri"],"minItems":1,"type":"array","items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","description":"a key for caching","type":"string"}},"cache_zone":{"default":"disk_cache_one","minLength":1,"type":"string","maxLength":100},"cache_strategy":{"default":"disk","enum":["disk","memory"],"type":"string"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"cache_http_status":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","description":"http response status","minimum":200},"default":[200,301,404],"minItems":1,"type":"array"},"cache_method":{"uniqueItems":true,"items":{"enum":["GET","POST","HEAD"],"description":"supported http method","type":"string"},"default":["GET","HEAD"],"minItems":1,"type":"array"},"disable":{"type":"boolean"},"hide_cache_headers":{"type":"boolean","default":false}}}},"ua-restriction":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"message":{"default":"Not allowed","minLength":1,"type":"string","maxLength":1024},"bypass_missing":{"type":"boolean","default":false},"allowlist":{"minItems":1,"type":"array","items":{"type":"string","minLength":1}},"denylist":{"minItems":1,"type":"array","items":{"type":"string","minLength":1}},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}}}},"priority":2999,"version":0.1},"referer-restriction":{"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"message":{"default":"Your referer host is not allowed","minLength":1,"type":"string","maxLength":1024},"bypass_missing":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"whitelist":{"minItems":1,"type":"array","items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"}},"blacklist":{"minItems":1,"type":"array","items":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"}}}},"priority":2990,"version":0.1},"traffic-split":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"disable":{"type":"boolean"},"rules":{"type":"array","items":{"type":"object","properties":{"match":{"type":"array","items":{"type":"object","properties":{"vars":{"type":"array"}}}},"weighted_upstreams":{"maxItems":20,"type":"array","items":{"type":"object","properties":{"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"weight":{"default":1,"type":"integer","description":"used to split traffic between differentupstreams for plugin configuration","minimum":0},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"type":"object","properties":{"labels":{"patternProperties":{".*":{"type":"string","minLength":1,"description":"value of label","pattern":"^\\S+$","maxLength":64}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"update_time":{"type":"integer"},"discovery_args":{"type":"object","properties":{"namespace_id":{"description":"namespace id","type":"string"},"group_name":{"description":"group name","type":"string"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_client","client_key"]}},"client_cert":{"required":["client_key"],"not":{"required":["client_cert_id"]}},"client_key":{"required":["client_cert"],"not":{"required":["client_cert_id"]}}},"type":"object","properties":{"verify":{"default":false,"type":"boolean","description":"Turn on server certificate verification, currently only kafka upstream is supported"},"client_cert_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"client_cert":{"minLength":128,"type":"string","maxLength":65536},"client_key":{"minLength":128,"type":"string","maxLength":65536}}},"keepalive_pool":{"type":"object","properties":{"requests":{"default":1000,"type":"integer","minimum":1},"size":{"default":320,"type":"integer","minimum":1},"idle_timeout":{"default":60,"type":"number","minimum":0}}},"type":{"description":"algorithms of load balancing","type":"string"},"timeout":{"required":["connect","send","read"],"type":"object","properties":{"connect":{"type":"number","exclusiveMinimum":0},"read":{"type":"number","exclusiveMinimum":0},"send":{"type":"number","exclusiveMinimum":0}}},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"type":"object","properties":{"passive":{"default":{"unhealthy":{"http_failures":0,"tcp_failures":0,"http_statuses":[429,500,503],"timeouts":0},"type":"http","healthy":{"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"successes":0}},"type":"object","properties":{"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,500,503],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0}}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"healthy":{"type":"object","properties":{"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"minItems":1,"type":"array"},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}}}}},"active":{"type":"object","properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"healthy":{"type":"object","properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[200,302],"minItems":1,"type":"array"},"interval":{"default":1,"type":"integer","minimum":1}}},"unhealthy":{"type":"object","properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":200},"default":[429,404,500,501,502,503,504,505],"minItems":1,"type":"array"},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"interval":{"default":1,"type":"integer","minimum":1}}},"req_headers":{"minItems":1,"type":"array","items":{"type":"string","uniqueItems":true}},"type":{"default":"http","enum":["http","https","tcp"],"type":"string"},"timeout":{"type":"number","default":1},"concurrency":{"type":"integer","default":10},"http_path":{"type":"string","default":"\/"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"https_verify_certificate":{"type":"boolean","default":true}}}}},"name":{"minLength":1,"type":"string","maxLength":100},"create_time":{"type":"integer"},"retries":{"type":"integer","minimum":0},"retry_timeout":{"type":"number","minimum":0},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"nodes":{"anyOf":[{"type":"object","patternProperties":{".*":{"type":"integer","description":"weight of node","minimum":0}}},{"type":"array","items":{"required":["host","port","weight"],"type":"object","properties":{"port":{"type":"integer","description":"port of node","minimum":1},"weight":{"type":"integer","description":"weight of node","minimum":0},"metadata":{"description":"metadata of node","type":"object"},"host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"priority":{"default":0,"description":"priority of node","type":"integer"}}}}]},"scheme":{"default":"http","enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"service_name":{"minLength":1,"type":"string","maxLength":256},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"desc":{"type":"string","maxLength":256},"upstream_host":{"type":"string","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"hash_on":{"default":"vars","enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string"}}}}},"default":[{"weight":1}],"minItems":1}}}},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}}}},"priority":966,"version":0.1},"authz-casdoor":{"schema":{"required":["callback_url","endpoint_addr","client_id","client_secret"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"client_secret":{"type":"string"},"callback_url":{"type":"string","pattern":"^[^%?]+[^\/]$"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"endpoint_addr":{"type":"string","pattern":"^[^%?]+[^\/]$"},"disable":{"type":"boolean"},"client_id":{"type":"string"}}},"priority":2559,"version":0.1},"request-validation":{"schema":{"$comment":"this is a mark for our injected plugin schema","anyOf":[{"required":["header_schema"]},{"required":["body_schema"]}],"type":"object","properties":{"rejected_code":{"maximum":599,"default":400,"type":"integer","minimum":200},"rejected_msg":{"minLength":1,"type":"string","maxLength":256},"header_schema":{"type":"object"},"body_schema":{"type":"object"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"}}},"priority":2800,"type":"validation","version":0.1},"hmac-auth":{"schema":{"$comment":"this is a mark for our injected plugin schema","title":"work with route or service object","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"}}},"type":"auth","version":0.1,"priority":2530,"consumer_schema":{"required":["access_key","secret_key"],"title":"work with consumer object","type":"object","properties":{"max_req_body":{"default":524288,"title":"Max request body size","type":"integer"},"access_key":{"minLength":1,"type":"string","maxLength":256},"secret_key":{"minLength":1,"type":"string","maxLength":256},"algorithm":{"default":"hmac-sha256","enum":["hmac-sha1","hmac-sha256","hmac-sha512"],"type":"string"},"clock_skew":{"type":"integer","default":0},"signed_headers":{"type":"array","items":{"minLength":1,"type":"string","maxLength":50}},"keep_headers":{"default":false,"title":"whether to keep the http request header","type":"boolean"},"encode_uri_params":{"default":true,"title":"Whether to escape the uri parameter","type":"boolean"},"validate_request_body":{"default":false,"title":"A boolean value telling the plugin to enable body validation","type":"boolean"}}}},"grpc-transcode":{"version":0.1,"priority":506,"schema":{"required":["proto_id","service","method"],"type":"object","additionalProperties":true,"properties":{"service":{"description":"the grpc service name","type":"string"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"deadline":{"default":0,"description":"deadline for grpc, millisecond","type":"number"},"proto_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"type":"string","maxLength":64},{"type":"integer","minimum":1}]},"pb_option":{"default":["enum_as_name","int64_as_number","auto_default_values","disable_hooks"],"minItems":1,"type":"array","items":{"type":"string","anyOf":[{"enum":["int64_as_number","int64_as_string","int64_as_hexstring"],"description":"enum as result","type":"string"},{"enum":["enum_as_name","enum_as_value"],"description":"int64 as result","type":"string"},{"enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"],"description":"default values option","type":"string"},{"enum":["enable_hooks","disable_hooks"],"description":"hooks option","type":"string"}]}},"method":{"description":"the method name in the grpc service.","type":"string"}},"$comment":"this is a mark for our injected plugin schema"}},"ip-restriction":{"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"message":{"default":"Your IP address is not allowed","minLength":1,"type":"string","maxLength":1024},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"whitelist":{"minItems":1,"type":"array","items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}},"blacklist":{"minItems":1,"type":"array","items":{"anyOf":[{"title":"IPv4","type":"string","format":"ipv4"},{"title":"IPv4\/CIDR","type":"string","pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$"},{"title":"IPv6","type":"string","format":"ipv6"},{"title":"IPv6\/CIDR","type":"string","pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$"}]}}}},"priority":3000,"version":0.1},"loggly":{"version":0.1,"metadata_schema":{"type":"object","properties":{"port":{"type":"integer","default":514},"protocol":{"default":"syslog","enum":["syslog","http","https"],"type":"string"},"timeout":{"default":5000,"type":"integer","minimum":1},"host":{"type":"string","default":"logs-01.loggly.com"},"log_format":{"type":"object"}}},"priority":411,"schema":{"required":["customer_token"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"include_req_body":{"type":"boolean","default":false},"severity":{"default":"INFO","enum":["INFO","info","DEBUG","debug","CRIT","crit","ALERT","alert","EMEGR","emegr","ERR","err","WARNING","warning","NOTICE","notice"],"type":"string","description":"base severity log level"},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"customer_token":{"type":"string"},"tags":{"default":["apisix"],"minItems":1,"type":"array","items":{"type":"string","pattern":"^(?!tag=)[ -~]*"}},"retry_delay":{"default":1,"type":"integer","minimum":0},"severity_map":{"patternProperties":{"^[1-5][0-9]{2}$":{"enum":["INFO","info","DEBUG","debug","CRIT","crit","ALERT","alert","EMEGR","emegr","ERR","err","WARNING","warning","NOTICE","notice"],"description":"keys are HTTP status code, values are severity","type":"string"}},"additionalProperties":false,"type":"object","description":"upstream response code vs syslog severity mapping"},"max_retry_count":{"default":0,"type":"integer","minimum":0},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"name":{"type":"string","default":"loggly"},"ssl_verify":{"type":"boolean","default":true},"include_resp_body":{"type":"boolean","default":false}}}},"api-breaker":{"schema":{"required":["break_response_code"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"unhealthy":{"default":{"http_statuses":[500],"failures":3},"type":"object","properties":{"http_statuses":{"uniqueItems":true,"items":{"maximum":599,"type":"integer","minimum":500},"default":[500],"minItems":1,"type":"array"},"failures":{"default":3,"type":"integer","minimum":1}}},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"break_response_code":{"maximum":599,"type":"integer","minimum":200},"break_response_body":{"type":"string"},"break_response_headers":{"type":"array","items":{"required":["key","value"],"type":"object","properties":{"key":{"type":"string","minLength":1},"value":{"type":"string","minLength":1}}}},"max_breaker_sec":{"default":300,"type":"integer","minimum":3},"disable":{"type":"boolean"},"healthy":{"default":{"http_statuses":[200],"successes":3},"type":"object","properties":{"http_statuses":{"uniqueItems":true,"items":{"maximum":499,"type":"integer","minimum":200},"default":[200],"minItems":1,"type":"array"},"successes":{"default":3,"type":"integer","minimum":1}}}}},"priority":1005,"version":0.1},"limit-conn":{"schema":{"required":["conn","burst","default_conn_delay","key"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"rejected_code":{"maximum":599,"default":503,"type":"integer","minimum":200},"rejected_msg":{"type":"string","minLength":1},"disable":{"type":"boolean"},"conn":{"type":"integer","exclusiveMinimum":0},"allow_degradation":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"default_conn_delay":{"type":"number","exclusiveMinimum":0},"only_use_default_delay":{"type":"boolean","default":false},"key":{"type":"string"},"burst":{"type":"integer","minimum":0},"key_type":{"default":"var","enum":["var","var_combination"],"type":"string"}}},"priority":1003,"version":0.1},"azure-functions":{"schema":{"required":["function_uri"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"function_uri":{"type":"string"},"disable":{"type":"boolean"},"authorization":{"type":"object","properties":{"clientid":{"type":"string"},"apikey":{"type":"string"}}},"keepalive_pool":{"default":5,"type":"integer","minimum":1},"keepalive":{"type":"boolean","default":true},"timeout":{"default":3000,"type":"integer","minimum":100},"ssl_verify":{"type":"boolean","default":true},"keepalive_timeout":{"default":60000,"type":"integer","minimum":1000},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}}}},"priority":-1900,"metadata_schema":{"type":"object","properties":{"master_apikey":{"type":"string","default":""},"master_clientid":{"type":"string","default":""}}},"version":0.1},"response-rewrite":{"schema":{"dependencies":{"filters":{"not":{"required":["body"]}},"body":{"not":{"required":["filters"]}}},"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"filters":{"type":"array","minItems":1,"description":"a group of filters that modify response bodyby replacing one specified string by another","items":{"required":["regex","replace"],"properties":{"scope":{"default":"once","enum":["once","global"],"description":"regex substitution range","type":"string"},"replace":{"description":"regex substitution content","type":"string"},"options":{"default":"jo","description":"regex options","type":"string"},"regex":{"minLength":1,"description":"match pattern on response body","type":"string"}},"description":"filter that modifies response body","type":"object"}},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"status_code":{"maximum":598,"type":"integer","description":"new status code for response","minimum":200},"body_base64":{"default":false,"description":"whether new body for response need base64 decode before return","type":"boolean"},"disable":{"type":"boolean"},"headers":{"type":"object","description":"new headers for response","minProperties":1},"vars":{"type":"array"},"body":{"description":"new body for response","type":"string"}}},"priority":899,"version":0.1},"cors":{"version":0.1,"priority":4000,"metadata_schema":{"type":"object","properties":{"allow_origins":{"type":"object","additionalProperties":{"type":"string","pattern":"^(\\*|\\*\\*|null|\\w+:\/\/[^,]+(,\\w+:\/\/[^,]+)*)$"}}}},"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"max_age":{"default":5,"description":"maximum number of seconds the results can be cached.-1 means no cached, the max value is depend on browser,more details plz check MDN. default: 5.","type":"integer"},"allow_headers":{"default":"*","description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","type":"string"},"allow_origins_by_metadata":{"type":"array","items":{"minLength":1,"type":"string","maxLength":4096},"minItems":1,"description":"set allowed origins by referencing origins in plugin metadata","uniqueItems":true},"allow_origins":{"default":"*","pattern":"^(\\*|\\*\\*|null|\\w+:\/\/[^,]+(,\\w+:\/\/[^,]+)*)$","description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *.","type":"string"},"expose_headers":{"default":"*","description":"you can use '*' to expose all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","type":"string"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"allow_credential":{"default":false,"description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options.","type":"boolean"},"allow_origins_by_regex":{"type":"array","items":{"minLength":1,"type":"string","maxLength":4096},"minItems":1,"description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com] to allow a.test.com and b.test.com","uniqueItems":true},"allow_methods":{"default":"*","description":"you can use '*' to allow all methods when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *.","type":"string"}}}},"serverless-post-function":{"version":0.1,"priority":-2000,"schema":{"required":["functions"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"functions":{"minItems":1,"type":"array","items":{"type":"string"}},"disable":{"type":"boolean"},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"phase":{"default":"access","enum":["rewrite","access","header_filter","body_filter","log","before_proxy"],"type":"string"}}}},"kafka-logger":{"version":0.1,"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}}},"priority":403,"schema":{"required":["broker_list","kafka_topic"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"inactive_timeout":{"default":5,"type":"integer","minimum":1},"broker_list":{"patternProperties":{".*":{"maximum":65535,"type":"integer","description":"the port of kafka broker","minimum":1}},"type":"object","minProperties":1},"meta_format":{"default":"default","enum":["default","origin"],"type":"string"},"timeout":{"default":3,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"name":{"type":"string","default":"kafka logger"},"disable":{"type":"boolean"},"buffer_duration":{"default":60,"type":"integer","minimum":1},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"max_retry_count":{"default":0,"type":"integer","minimum":0},"include_req_body":{"type":"boolean","default":false},"retry_delay":{"default":1,"type":"integer","minimum":0},"kafka_topic":{"type":"string"},"producer_type":{"default":"async","enum":["async","sync"],"type":"string"},"key":{"type":"string"},"required_acks":{"default":1,"enum":[0,1,-1],"type":"integer"},"cluster_name":{"default":1,"type":"integer","minimum":1},"producer_batch_num":{"default":200,"type":"integer","minimum":1},"producer_batch_size":{"default":1048576,"type":"integer","minimum":0},"producer_max_buffering":{"default":50000,"type":"integer","minimum":1},"producer_time_linger":{"default":1,"type":"integer","minimum":1},"include_req_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"include_resp_body":{"type":"boolean","default":false}}}},"ext-plugin-post-req":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"allow_degradation":{"type":"boolean","default":false},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"conf":{"minItems":1,"type":"array","items":{"required":["name","value"],"type":"object","properties":{"value":{"type":"string"},"name":{"minLength":1,"type":"string","maxLength":128}}}}},"type":"object"},"priority":-3000,"version":0.1},"http-logger":{"version":0.1,"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}}},"priority":410,"schema":{"required":["uri"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"include_resp_body_expr":{"minItems":1,"type":"array","items":{"type":"array"}},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"include_req_body":{"type":"boolean","default":false},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"auth_header":{"type":"string"},"max_retry_count":{"default":0,"type":"integer","minimum":0},"uri":{"type":"string","pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"timeout":{"default":3,"type":"integer","minimum":1},"ssl_verify":{"type":"boolean","default":false},"name":{"type":"string","default":"http logger"},"concat_method":{"default":"json","enum":["json","new_line"],"type":"string"},"include_resp_body":{"type":"boolean","default":false}}}},"consumer-restriction":{"schema":{"$comment":"this is a mark for our injected plugin schema","anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}],"type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"rejected_code":{"default":403,"type":"integer","minimum":200},"type":{"default":"consumer_name","enum":["consumer_name","service_id","route_id"],"type":"string"},"disable":{"type":"boolean"},"rejected_msg":{"type":"string"},"allowed_by_methods":{"type":"array","items":{"type":"object","properties":{"methods":{"minItems":1,"type":"array","items":{"enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"],"description":"HTTP method","type":"string"}},"user":{"type":"string"}}}},"whitelist":{"minItems":1,"type":"array","items":{"type":"string"}},"blacklist":{"minItems":1,"type":"array","items":{"type":"string"}}}},"priority":2400,"version":0.1},"sls-logger":{"schema":{"required":["host","port","project","logstore","access_key_id","access_key_secret"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"port":{"type":"integer"},"host":{"type":"string"},"include_req_body":{"type":"boolean","default":false},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"name":{"type":"string","default":"sls-logger"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"max_retry_count":{"default":0,"type":"integer","minimum":0},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"timeout":{"default":5000,"type":"integer","minimum":1},"project":{"type":"string"},"logstore":{"type":"string"},"access_key_id":{"type":"string"},"access_key_secret":{"type":"string"}}},"priority":406,"version":0.1},"authz-keycloak":{"schema":{"$comment":"this is a mark for our injected plugin schema","allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"required":["client_id"]},{"required":["audience"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"properties":{"lazy_load_paths":{"enum":[true]}},"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}]}]}],"type":"object","properties":{"lazy_load_paths":{"type":"boolean","default":false},"http_method_as_scope":{"type":"boolean","default":false},"cache_ttl_seconds":{"default":86400,"type":"integer","minimum":1},"access_denied_redirect_uri":{"minLength":1,"type":"string","maxLength":2048},"refresh_token_expires_in":{"default":3600,"type":"integer","minimum":1},"refresh_token_expires_leeway":{"default":0,"type":"integer","minimum":0},"password_grant_token_generation_incoming_uri":{"minLength":1,"type":"string","maxLength":4096},"client_id":{"minLength":1,"type":"string","maxLength":100},"timeout":{"default":3000,"type":"integer","minimum":1000},"ssl_verify":{"type":"boolean","default":true},"grant_type":{"enum":["urn:ietf:params:oauth:grant-type:uma-ticket"],"type":"string","default":"urn:ietf:params:oauth:grant-type:uma-ticket","minLength":1,"maxLength":100},"discovery":{"minLength":1,"type":"string","maxLength":4096},"permissions":{"default":{},"uniqueItems":true,"type":"array","items":{"minLength":1,"type":"string","maxLength":100}},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"disable":{"type":"boolean"},"access_token_expires_leeway":{"default":0,"type":"integer","minimum":0},"access_token_expires_in":{"default":300,"type":"integer","minimum":1},"keepalive_pool":{"default":5,"type":"integer","minimum":1},"resource_registration_endpoint":{"minLength":1,"type":"string","maxLength":4096},"keepalive":{"type":"boolean","default":true},"policy_enforcement_mode":{"default":"ENFORCING","enum":["ENFORCING","PERMISSIVE"],"type":"string"},"token_endpoint":{"minLength":1,"type":"string","maxLength":4096},"keepalive_timeout":{"default":60000,"type":"integer","minimum":1000},"audience":{"description":"Deprecated, use `client_id` instead.","minLength":1,"type":"string","maxLength":100},"client_secret":{"minLength":1,"type":"string","maxLength":100}}},"priority":2000,"version":0.1},"splunk-hec-logging":{"schema":{"required":["endpoint"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"inactive_timeout":{"default":5,"type":"integer","minimum":1},"retry_delay":{"default":1,"type":"integer","minimum":0},"endpoint":{"required":["uri","token"],"type":"object","properties":{"uri":{"type":"string","pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?"},"timeout":{"default":10,"type":"integer","minimum":1},"token":{"type":"string"},"channel":{"type":"string"}}},"disable":{"type":"boolean"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"ssl_verify":{"type":"boolean","default":true},"name":{"type":"string","default":"splunk-hec-logging"},"buffer_duration":{"default":60,"type":"integer","minimum":1},"max_retry_count":{"default":0,"type":"integer","minimum":0}}},"priority":409,"version":0.1},"zipkin":{"version":0.1,"priority":12011,"schema":{"required":["endpoint","sample_ratio"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"server_addr":{"pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$","type":"string","description":"default is $server_addr, you can specify your external ip address"},"span_version":{"default":2,"enum":[1,2]},"endpoint":{"type":"string"},"disable":{"type":"boolean"},"sample_ratio":{"maximum":1,"type":"number","minimum":1e-05},"service_name":{"default":"APISIX","type":"string","description":"service name for zipkin reporter"}}}},"mocking":{"schema":{"$comment":"this is a mark for our injected plugin schema","anyOf":[{"required":["response_example"]},{"required":["response_schema"]}],"type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"response_example":{"type":"string"},"response_schema":{"type":"object"},"with_mock_header":{"type":"boolean","default":true},"disable":{"type":"boolean"},"response_status":{"default":200,"type":"integer","minimum":100},"delay":{"type":"integer","default":0},"content_type":{"type":"string","default":"application\/json;charset=utf8"}}},"priority":10900,"version":0.1},"clickhouse-logger":{"schema":{"required":["endpoint_addr","user","password","database","logtable"],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"max_retry_count":{"default":0,"type":"integer","minimum":0},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"database":{"type":"string","default":""},"user":{"type":"string","default":""},"password":{"type":"string","default":""},"timeout":{"default":3,"type":"integer","minimum":1},"ssl_verify":{"type":"boolean","default":true},"endpoint_addr":{"type":"string","pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?"},"logtable":{"type":"string","default":""},"name":{"type":"string","default":"clickhouse-logger"}}},"metadata_schema":{"type":"object","properties":{"log_format":{"type":"object","default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"}}}},"priority":398,"version":0.1},"google-cloud-logging":{"schema":{"oneOf":[{"required":["auth_config"]},{"required":["auth_file"]}],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"max_retry_count":{"default":0,"type":"integer","minimum":0},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"auth_file":{"type":"string"},"log_id":{"type":"string","default":"apisix.apache.org%2Flogs"},"inactive_timeout":{"default":5,"type":"integer","minimum":1},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"auth_config":{"required":["private_key","project_id","token_uri"],"type":"object","properties":{"entries_uri":{"type":"string","default":"https:\/\/logging.googleapis.com\/v2\/entries:write"},"private_key":{"type":"string"},"token_uri":{"type":"string","default":"https:\/\/oauth2.googleapis.com\/token"},"project_id":{"type":"string"},"scopes":{"uniqueItems":true,"items":{"description":"Google OAuth2 Authorization Scopes","type":"string"},"default":["https:\/\/www.googleapis.com\/auth\/logging.read","https:\/\/www.googleapis.com\/auth\/logging.write","https:\/\/www.googleapis.com\/auth\/logging.admin","https:\/\/www.googleapis.com\/auth\/cloud-platform"],"minItems":1,"type":"array"}}},"ssl_verify":{"type":"boolean","default":true},"name":{"type":"string","default":"google-cloud-logging"},"resource":{"default":{"type":"global"},"required":["type"],"type":"object","properties":{"type":{"type":"string"},"labels":{"type":"object"}}},"batch_max_size":{"default":1000,"type":"integer","minimum":1}}},"priority":407,"version":0.1},"datadog":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"max_retry_count":{"default":0,"type":"integer","minimum":0},"retry_delay":{"default":1,"type":"integer","minimum":0},"buffer_duration":{"default":60,"type":"integer","minimum":1},"disable":{"type":"boolean"},"prefer_name":{"type":"boolean","default":true},"_meta":{"type":"object","properties":{"filter":{"maxItems":20,"type":"array","description":"filter determines whether the plugin needs to be executed at runtime","items":{"type":"array"}},"priority":{"description":"priority of plugins by customized order","type":"integer"},"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]}}},"name":{"type":"string","default":"datadog"},"batch_max_size":{"default":1000,"type":"integer","minimum":1},"inactive_timeout":{"default":5,"type":"integer","minimum":1}}},"metadata_schema":{"type":"object","properties":{"port":{"default":8125,"type":"integer","minimum":0},"constant_tags":{"default":["source:apisix"],"type":"array","items":{"type":"string"}},"host":{"type":"string","default":"127.0.0.1"},"namespace":{"type":"string","default":"apisix"}}},"priority":495,"version":0.1}}}
